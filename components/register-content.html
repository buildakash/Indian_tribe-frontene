<!-- Register Breadcrumb Component -->
<div class="breadcrumb-block style-shared">
  <div class="breadcrumb-main bg-linear overflow-hidden">
    <div class="container lg:pt-[134px] pt-24 pb-10 relative">
      <div
        class="main-content w-full h-full flex flex-col items-center justify-center relative z-[1]"
      >
        <div class="text-content">
          <div class="heading2 text-center">Register</div>
          <div
            class="link flex items-center justify-center gap-1 caption1 mt-3"
          >
            <a href="index.html">Homepage</a>
            <i class="ph ph-caret-right text-sm text-secondary2"></i>
            <div class="text-secondary2 capitalize">Register</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Register Content Component (FINAL POLISHED VERSION) -->
<div class="register-block md:py-20 py-10">
  <div class="container">
    <div class="content-main flex gap-y-8 max-md:flex-col">
      <div
        class="left md:w-1/2 w-full lg:pr-[60px] md:pr-[40px] md:border-r border-line"
      >
        <div class="heading4">Register</div>

        <!-- Step 1: Registration Form -->
        <form id="registrationForm" class="md:mt-7 mt-4" style="display: block">
          <div class="name mb-5">
            <label for="name" class="form-label">Full Name *</label>
            <input
              class="border-line px-4 pt-3 pb-3 w-full rounded-lg"
              id="name"
              type="text"
              placeholder="Full Name *"
              required
            />
            <div
              class="error-message text-red-500 text-sm mt-1 hidden"
              id="nameError"
            ></div>
          </div>

          <div class="phone mb-5">
            <label for="phone" class="form-label">Phone Number *</label>
            <input
              class="border-line px-4 pt-3 pb-3 w-full rounded-lg"
              id="phone"
              type="tel"
              placeholder="Phone Number (10 digits) *"
              maxlength="10"
              required
            />
            <div
              class="error-message text-red-500 text-sm mt-1 hidden"
              id="phoneError"
            ></div>
          </div>

          <div class="email mb-5">
            <label for="email" class="form-label">Email Address *</label>
            <input
              class="border-line px-4 pt-3 pb-3 w-full rounded-lg"
              id="email"
              type="email"
              placeholder="Email Address *"
              required
            />
            <div
              class="error-message text-red-500 text-sm mt-1 hidden"
              id="emailError"
            ></div>
          </div>

          <div class="pass mb-5">
            <div class="flex items-center justify-between mb-2">
              <label for="password" class="form-label mb-0">Password *</label>
            </div>
            <div class="password-strength-wrapper mb-2 flex items-center gap-2 relative">
              <!-- <span class="text-sm font-medium">Password strength</span> -->
            
              <div class="relative group">
                <!-- <i class="ph ph-info text-gray-500 cursor-pointer"></i> -->
            
                <!-- Tooltip -->
                <!-- <div
                  id="passwordInfoTooltip"
                  class="absolute left-6 top-0 z-50 bg-white border border-gray-200 rounded-lg shadow-lg w-64 p-4 text-xs opacity-0 invisible group-hover:opacity-100 group-hover:visible transition duration-300"
                >
                  <div class="font-semibold text-gray-700 mb-2">Password must contain:</div>
                  <ul class="space-y-1">
                    <li class="flex items-center gap-2 text-gray-600">
                      <i class="ph ph-circle text-red-400"></i> At least 8 characters
                    </li>
                    <li class="flex items-center gap-2 text-gray-600">
                      <i class="ph ph-circle text-red-400"></i> One uppercase letter
                    </li>
                    <li class="flex items-center gap-2 text-gray-600">
                      <i class="ph ph-circle text-red-400"></i> One lowercase letter
                    </li>
                    <li class="flex items-center gap-2 text-gray-600">
                      <i class="ph ph-circle text-red-400"></i> One number
                    </li>
                    <li class="flex items-center gap-2 text-gray-600">
                      <i class="ph ph-circle text-red-400"></i> One special character (!@#…)
                    </li>
                  </ul>
                </div> -->
              </div>
            </div>
            
            
            <div id="password-strength-indicator" class="flex gap-1 mb-3"></div>
           
            <div class="relative">
              <input
                class="border-line px-4 pt-3 pb-3 w-full rounded-lg pr-12"
                id="password"
                type="password"
                placeholder="Password *"
                required
              />
              <button
                type="button"
                class="absolute right-3 top-1/2 -translate-y-1/2"
                id="togglePassword"
                aria-label="Toggle password"
              >
                <i class="ph ph-eye text-lg"></i>
              </button>
            </div>

            <div
              class="error-message text-red-500 text-sm mt-1 hidden"
              id="passwordError"
            ></div>
          </div>

          <div class="confirm-pass mb-5">
            <label for="confirmPassword" class="form-label"
              >Confirm Password *</label
            >
            <div class="relative">
              <input
                class="border-line px-4 pt-3 pb-3 w-full rounded-lg pr-12"
                id="confirmPassword"
                type="password"
                placeholder="Confirm Password *"
                required
              />
              <button
                type="button"
                class="absolute right-3 top-1/2 -translate-y-1/2"
                id="toggleConfirmPassword"
                aria-label="Toggle confirm password"
              >
                <i class="ph ph-eye text-lg"></i>
              </button>
            </div>
            <!-- ADDED: Placeholder for the confirm password match indicator -->
            <div id="confirm-password-indicator" class="text-xs mt-1"></div>
            <div
              class="error-message text-red-500 text-sm mt-1 hidden"
              id="confirmPasswordError"
            ></div>
          </div>

          <div class="flex items-center mb-5">
            <div class="block-input">
              <input type="checkbox" name="remember" id="remember" required />
              <i class="ph-fill ph-check-square icon-checkbox text-2xl"></i>
            </div>
            <label for="remember" class="pl-2 cursor-pointer text-secondary2">
              I agree to the
              <a href="#!" class="text-black hover:underline pl-1"
                >Terms of Use</a
              >
            </label>
          </div>

          <div class="block-button md:mt-7 mt-4">
            <button type="submit" class="button-main w-full" id="registerBtn">
              <span class="btn-text">Register</span>
              <span class="btn-loading hidden">
                <i class="ph ph-circle-notch animate-spin mr-2"></i>
                Sending OTP...
              </span>
            </button>
          </div>
        </form>

        <!-- Step 2: OTP Verification -->
        <div id="otpVerification" class="md:mt-7 mt-4" style="display: none">
          <div class="text-center mb-6">
            <div class="heading5 mb-2">Verify Your Email</div>
            <div class="text-secondary">
              We've sent a 6-digit OTP to
              <span class="font-semibold" id="otpEmail"></span>
            </div>
            <div class="text-sm text-secondary mt-1">
              Check your inbox and enter the code below
            </div>
          </div>

          <form id="otpForm" autocomplete="off">
            <div class="otp-inputs flex justify-center gap-3 mb-6">
              <input
                type="text"
                class="otp-digit w-12 h-12 text-center border border-line rounded-lg text-lg font-semibold transition-colors"
                maxlength="1"
                data-index="0"
                autocomplete="off"
              />
              <input
                type="text"
                class="otp-digit w-12 h-12 text-center border border-line rounded-lg text-lg font-semibold transition-colors"
                maxlength="1"
                data-index="1"
                autocomplete="off"
              />
              <input
                type="text"
                class="otp-digit w-12 h-12 text-center border border-line rounded-lg text-lg font-semibold transition-colors"
                maxlength="1"
                data-index="2"
                autocomplete="off"
              />
              <input
                type="text"
                class="otp-digit w-12 h-12 text-center border border-line rounded-lg text-lg font-semibold transition-colors"
                maxlength="1"
                data-index="3"
                autocomplete="off"
              />
              <input
                type="text"
                class="otp-digit w-12 h-12 text-center border border-line rounded-lg text-lg font-semibold transition-colors"
                maxlength="1"
                data-index="4"
                autocomplete="off"
              />
              <input
                type="text"
                class="otp-digit w-12 h-12 text-center border border-line rounded-lg text-lg font-semibold transition-colors"
                maxlength="1"
                data-index="5"
                autocomplete="off"
              />
            </div>

            <div
              id="otpErrorMsg"
              class="text-center text-red-500 text-sm mb-2 hidden"
            ></div>

            <div class="text-center mb-6">
              <div class="timer text-sm text-secondary mb-3">
                <span>OTP expires in: </span>
                <span class="font-semibold text-red-500" id="otpTimer"
                  >00:60</span
                >
              </div>
              <button
                type="button"
                class="text-sm text-black hover:underline"
                id="resendOtpBtn"
                disabled
              >
                Resend OTP
              </button>
            </div>

            <div class="block-button">
              <button
                type="submit"
                class="button-main w-full"
                id="verifyOtpBtn"
              >
                <span class="btn-text">Verify &amp; Complete Registration</span>
                <span class="btn-loading hidden">
                  <i class="ph ph-circle-notch animate-spin mr-2"></i>
                  Verifying...
                </span>
              </button>
            </div>

            <div class="text-center mt-4">
              <button
                type="button"
                class="text-sm text-secondary hover:text-black"
                id="backToForm"
              >
                ← Back to form
              </button>
            </div>
          </form>
          <script>
            // OTP input color feedback logic
            document.addEventListener("DOMContentLoaded", function () {
              const otpForm = document.getElementById("otpForm");
              const otpInputs = otpForm.querySelectorAll(".otp-digit");
              const verifyBtn = document.getElementById("verifyOtpBtn");
              const otpErrorMsg = document.getElementById("otpErrorMsg");

              // Remove color classes from all inputs
              function resetOtpInputColors() {
                otpInputs.forEach((input) => {
                  input.classList.remove(
                    "bg-green-100",
                    "bg-red-100",
                    "border-green-500",
                    "border-red-500"
                  );
                });
              }

              // Set all inputs to green
              function setOtpInputsGreen() {
                otpInputs.forEach((input) => {
                  input.classList.remove("bg-red-100", "border-red-500");
                  input.classList.add("bg-green-100", "border-green-500");
                });
              }

              // Set all inputs to red
              function setOtpInputsRed() {
                otpInputs.forEach((input) => {
                  input.classList.remove("bg-green-100", "border-green-500");
                  input.classList.add("bg-red-100", "border-red-500");
                });
              }

              // On submit, handle OTP verification and color feedback
              otpForm.addEventListener("submit", function (e) {
                e.preventDefault();
                resetOtpInputColors();
                otpErrorMsg.classList.add("hidden");
                otpErrorMsg.textContent = "";

                // Collect OTP value
                let otp = "";
                otpInputs.forEach((input) => {
                  otp += input.value.trim();
                });

                // Show loading state
                verifyBtn.disabled = true;
                verifyBtn.querySelector(".btn-text").classList.add("hidden");
                verifyBtn
                  .querySelector(".btn-loading")
                  .classList.remove("hidden");

                // Simulate AJAX request to verify OTP (replace with your actual AJAX)
                // Example: POST to /api/verify-otp with {otp: otp, ...}
                fetch("/api/verify-registration-otp", {
                  method: "POST",
                  headers: { "Content-Type": "application/json" },
                  body: JSON.stringify({ otp: otp }),
                })
                  .then((res) => res.json())
                  .then((data) => {
                    if (data.status === "success") {
                      setOtpInputsGreen();
                      // Optionally, proceed to next step after a short delay
                      setTimeout(() => {
                        // You may want to trigger the registration success UI here
                        document.getElementById(
                          "otpVerification"
                        ).style.display = "none";
                        document.getElementById(
                          "successMessage"
                        ).style.display = "";
                      }, 500);
                    } else {
                      setOtpInputsRed();
                      otpErrorMsg.textContent =
                        data.message || "Invalid OTP. Please try again.";
                      otpErrorMsg.classList.remove("hidden");
                    }
                  })
                  .catch(() => {
                    setOtpInputsRed();
                    otpErrorMsg.textContent =
                      "An error occurred. Please try again.";
                    otpErrorMsg.classList.remove("hidden");
                  })
                  .finally(() => {
                    verifyBtn.disabled = false;
                    verifyBtn
                      .querySelector(".btn-text")
                      .classList.remove("hidden");
                    verifyBtn
                      .querySelector(".btn-loading")
                      .classList.add("hidden");
                  });
              });
            });
          </script>
        </div>

        <!-- Step 3: Success -->
        <div
          id="successMessage"
          class="md:mt-7 mt-4 text-center"
          style="display: none"
        >
          <div class="success-icon text-6xl text-green-500 mb-4">✅</div>
          <div class="heading4 text-green-500 mb-3">
            Registration Successful!
          </div>
          <div class="text-secondary mb-6">
            Welcome to Indian Tribe! Your account has been created successfully.
          </div>
          <a href="login.html" class="button-main">Login Now</a>
        </div>

        <script>
          // OTP input color feedback logic
          document.addEventListener("DOMContentLoaded", function () {
            const otpForm = document.getElementById("otpForm");
            const otpInputs = otpForm.querySelectorAll(".otp-digit");
            const verifyBtn = document.getElementById("verifyOtpBtn");
            const otpErrorMsg = document.getElementById("otpErrorMsg");

            // Remove color classes from all inputs
            function resetOtpInputColors() {
              otpInputs.forEach((input) => {
                input.classList.remove(
                  "bg-green-100",
                  "bg-red-100",
                  "border-green-500",
                  "border-red-500"
                );
              });
            }

            // Set all inputs to green
            function setOtpInputsGreen() {
              otpInputs.forEach((input) => {
                input.classList.remove("bg-red-100", "border-red-500");
                input.classList.add("bg-green-100", "border-green-500");
              });
            }

            // Set all inputs to red
            function setOtpInputsRed() {
              otpInputs.forEach((input) => {
                input.classList.remove("bg-green-100", "border-green-500");
                input.classList.add("bg-red-100", "border-red-500");
              });
            }

            // On submit, handle OTP verification and color feedback
            otpForm.addEventListener("submit", function (e) {
              e.preventDefault();
              resetOtpInputColors();
              otpErrorMsg.classList.add("hidden");
              otpErrorMsg.textContent = "";

              // Collect OTP value
              let otp = "";
              otpInputs.forEach((input) => {
                otp += input.value.trim();
              });

              // Show loading state
              verifyBtn.disabled = true;
              verifyBtn.querySelector(".btn-text").classList.add("hidden");
              verifyBtn
                .querySelector(".btn-loading")
                .classList.remove("hidden");

              // Simulate AJAX call to verify OTP (replace with real AJAX in production)
              fetch("/api/verify-registration-otp", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ otp: otp }),
              })
                .then((res) => res.json())
                .then((data) => {
                  if (data.status === "success") {
                    setOtpInputsGreen();
                    // Optionally, proceed to success message after a short delay
                    setTimeout(() => {
                      document.getElementById("otpVerification").style.display =
                        "none";
                      document.getElementById("successMessage").style.display =
                        "";
                    }, 800);
                  } else {
                    setOtpInputsRed();
                    otpErrorMsg.textContent =
                      data.message || "Invalid OTP. Please try again.";
                    otpErrorMsg.classList.remove("hidden");
                  }
                })
                .catch(() => {
                  setOtpInputsRed();
                  otpErrorMsg.textContent =
                    "An error occurred. Please try again.";
                  otpErrorMsg.classList.remove("hidden");
                })
                .finally(() => {
                  verifyBtn.disabled = false;
                  verifyBtn
                    .querySelector(".btn-text")
                    .classList.remove("hidden");
                  verifyBtn
                    .querySelector(".btn-loading")
                    .classList.add("hidden");
                });
            });

            // Remove error/success color when user starts editing
            otpInputs.forEach((input) => {
              input.addEventListener("input", function () {
                resetOtpInputColors();
                otpErrorMsg.classList.add("hidden");
                otpErrorMsg.textContent = "";
              });
            });
          });
        </script>
      </div>

      <div
        class="right md:w-1/2 w-full lg:pl-[60px] md:pl-[40px] flex items-center"
      >
        <div class="text-content">
          <div class="heading4">Already have an account?</div>
          <div class="mt-2 text-secondary">
            Welcome back. Sign in to access your personalized experience, saved
            preferences, and more. We're thrilled to have you with us again!
          </div>
          <div class="block-button md:mt-7 mt-4">
            <a href="login.html" class="button-main">Login</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
